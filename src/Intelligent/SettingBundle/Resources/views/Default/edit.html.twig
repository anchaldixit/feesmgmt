{# Intelligent/SettingBundle/Resources/views/Default/edit.html.twig #}
{% extends "base.html.twig"  %}

{% block javascripts %}
    {{ parent() }}
    <script>
        jQuery(document).ready(function ($) {

            $('#fieldname_edit').on('click', function () {
                $('#module_field_name').attr('READONLY', false).focus();
                return false;
            });
            $('#module_field_datatype').on('change', function () {

                if ($(this).val() == 'enum') {
                    $('#value_row').slideDown('slow')

                } else {
                    $('#value_row').slideUp('slow')

                }
                if ($(this).val() == 'link') {
                    $('#link_text_row').slideDown('slow')

                } else {
                    $('#link_text_row').slideUp('slow')
                }
            }).trigger('change');

            $('#field_has_relationship').on('change', function () {

                if ($(this).val() == 'Y') {
                    $('#relationship_module_row').slideDown('slow');

                } else {
                    $('#relationship_module_row').slideUp('slow');
                }

            }).trigger('change');

            if ($('#edit_id_hidden_field').length) {
                $('#module_field_datatype').attr('DISABLED', true);
                $('#module').attr('DISABLED', true);
                $('#relationship_module').attr('DISABLED', true);
                $('#field_has_relationship').attr('DISABLED', true);

                $('#fieldname_edit').hide();
            }

        });

    </script>
{% endblock %}
{% block body %}
    <a href="/app_dev.php/settings/edit/new">New</a>
    <h1>Edit Settings</h1>
    {% if msg is defined and msg is not empty %}
        <div style="color:red"> {{msg}} </div>
    {% endif %}
    <form action="" method="POST">
        <ul>
            {% for config in field %}

                <li><label>Module:</label> 
                    <select name="module" id="module" >
                        <option value="">Select Module...</option>
                        {% for keyname, module in modules %}
                            <option value="{{keyname}}" {{config.module is defined and config.module == keyname ? 'SELECTED': ''}}>{{module}}</option>
                        {% endfor %}
                    </select>
                </li>

                <li><label>Module Field Name:</label> 
                    <input name="module_field_display_name" id="module_field_display_name"  value="{{config.module_field_display_name is defined ? config.module_field_display_name : ''}}" type="text" ><br></li>
                <li>
                    <label>Module Field Identifier:</label> 
                    <input name="module_field_name" id="module_field_name"  value = "{{config.module_field_name is defined ? config.module_field_name : ''}}" type="text" readonly> <a href="#" id="fieldname_edit">Click to edit field, default is autogenerated.</a><br></li>
                <li>Module Field Type: 
                    <select name="module_field_datatype" id="module_field_datatype" >
                        {% for keyname, datatype in datatypes %} 
                            <option value="{{keyname}}" {{config.module_field_datatype is defined and config.module_field_datatype == keyname ? 'SELECTED': ''}}>{{datatype}}</option>
                        {% endfor %}
                    </select><br>
                </li>
                <li id="value_row">
                    <label>Value Set:</label> 
                    <input name="value" id="value" value="{{config.value is defined ? config.value : 'value1|value2|value3'}}"><br>
                </li>
                <li id="link_text_row">
                    <label>Link Text:</label> 
                    <input name="link_text" id="link_text" value="{{config.link_text is defined ? config.link_text : ''}}"><br>
                </li>
                <li id="enable_filter_row"><label>Enable Filter:</label> 
                    <select name="enable_filter" id="enable_filter" >
                        <option value="N" {{config.enable_filter is defined and config.enable_filter == 'N' ? 'SELECTED': ''}}>No</option>
                        <option value="Y" {{config.enable_filter is defined and config.enable_filter == 'Y' ? 'SELECTED': ''}}>Yes</option>
                    </select><br>
                </li>
                <li> <label>Show in Grid:</label> 
                    <select name="show_in_grid" id="show_in_grid" >
                        <option value="Y" {{config.show_in_grid is defined and config.show_in_grid == 'Y' ? 'SELECTED': ''}}>Yes</option>
                        <option value="N" {{config.show_in_grid is defined and config.show_in_grid == 'N' ? 'SELECTED': ''}}>No</option>

                    </select><br>
                </li>
                <li id="field_has_relationship_row"><label>Is a foreign key:</label> 
                    <select name="is_" id="field_has_relationship" >
                        <option value="N" {{config.relationship_module is defined and config.relationship_module is empty ? 'SELECTED': ''}}>No</option>
                        <option value="Y" {{config.relationship_module is defined and config.relationship_module is not empty ? 'SELECTED': ''}}>Yes</option>
                    </select><br></li>
                <li id="relationship_module_row"> 
                    <label>Relationship Table: </label>
                    <select name="relationship_module" id="relationship_module" >
                        <option value="">Select Module..</option>
                        {% for keyname, module in modules %}
                            <option value="{{keyname}}" {{config.relationship_module is defined and config.relationship_module == keyname ? 'SELECTED': ''}}>{{module}}</option>
                        {% endfor %}
                    </select>
                </li>
                {% if config.modified_datetime is defined %}
                    <li> 
                        <label>Last Modified:</label> 
                        {{config.modified_datetime}}<br>
                    </li>
                    <li>
                        <label>Modified by:</label> 
                        {{config.modified_by}}
                    </li>
                {% endif %}


                {% if id is defined and id is not empty %}
                    <input type="hidden" name="id" id="edit_id_hidden_field" value="{{id}}">
                    <input type="hidden" name="module_field_datatype" value="{{config.module_field_datatype}}">
                    <input type="submit" name="edit_submit" value="Edit" > 
                    <input type="submit" name="delete_submit" value="Delete" >
                {% else %}
                    <input type="submit" name="add_submit" value="Add" > 
                {% endif %}
            {% endfor %}

        </ul>
    </form>



{% endblock %}